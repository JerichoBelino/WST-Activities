<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.5/dist/jquery.validate.min.js"></script>

  <link rel="stylesheet" href="style.css"> 
</head>

<body>
  <div class="overlay"></div>

  <div class="auth-container">
    <ul class="nav nav-tabs" id="authTabs">
      <li class="nav-item">
        <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#login">Login</button>
      </li>
      <li class="nav-item">
        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#signup">Sign Up</button>
      </li>
    </ul>

    <div class="tab-content">
      <div class="tab-pane fade show active" id="login">
        <h3>Welcome Back</h3>
        <form id="loginForm">
          <div class="mb-3">
            <label class="form-label">Username</label>
            <input type="text" class="form-control" name="username" placeholder="Enter your registered username" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Password</label>
            <div class="input-group">
              <input type="password" class="form-control" name="password" id="loginPassword" placeholder="Enter your password" required>
              <span class="input-group-text" onclick="togglePassword('loginPassword','loginIcon')">
                <i class="bi bi-eye" id="loginIcon"></i>
              </span>
            </div>
          </div>
          <button type="submit" class="btn btn-custom w-100">Login</button>
        </form>
      </div>

      <div class="tab-pane fade" id="signup">
        <h3>Create Account</h3>
        <form id="registerForm">
          <div class="mb-3">
            <label class="form-label">Full Name</label>
            <input type="text" class="form-control" name="fullname" placeholder="Enter your full name" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Username</label>
            <input type="text" class="form-control" name="reg_username" placeholder="Choose a username" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Email</label>
            <input type="email" class="form-control" name="email" placeholder="Enter your email" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Password</label>
            <div class="input-group">
              <input type="password" class="form-control" name="password" id="signupPassword" placeholder="Create a password" required>
              <span class="input-group-text" onclick="togglePassword('signupPassword','signupIcon')">
                <i class="bi bi-eye" id="signupIcon"></i>
              </span>
            </div>
          </div>
          <div class="mb-3">
            <label class="form-label">Confirm Password</label>
            <div class="input-group">
              <input type="password" class="form-control" id="confirmPassword" name="confirm_password" placeholder="Confirm your password" required>
              <span class="input-group-text" onclick="togglePassword('confirmPassword','confirmIcon')">
                <i class="bi bi-eye" id="confirmIcon"></i>
              </span>
            </div>
          </div>
          <button type="submit" class="btn btn-custom w-100">Sign Up</button>
        </form>
      </div>
    </div>
  </div>

  <script>
    // Toggle Password Visibility
    function togglePassword(inputId, iconId) {
      const input = document.getElementById(inputId);
      const icon = document.getElementById(iconId);
      const isPassword = input.type === "password";
      input.type = isPassword ? "text" : "password";
      icon.classList.toggle("bi-eye", !isPassword);
      icon.classList.toggle("bi-eye-slash", isPassword);
    }

    // jQuery Validation for Login
    $("#loginForm").validate({
      rules: {
        username: "required",
        password: "required"
      },
      messages: {
        username: "Please enter your username",
        password: "Please enter your password"
      },
      submitHandler: function(form) {
        let user = $(form).find("input[name='username']").val();
        let pass = $(form).find("input[name='password']").val(); 

        let storedUsername = localStorage.getItem("registeredUsername");
        let storedPass = localStorage.getItem("registeredPass");

        if(user === storedUsername && pass === storedPass){
          localStorage.setItem("loggedInUser", user);
          // Redirect the user on successful login
          window.location.href = "landing-page.html";
        } else {
          alert("Invalid username or password! Please register first.");
        }
      }
    });

    // jQuery Validation for Registration
    $("#registerForm").validate({
      rules: {
        fullname: "required",
        reg_username: {
          required: true,
          minlength: 3
        },
        email: {
          required: true,
          email: true
        },
        // Note: This password field also has name="password"
        password: { 
          required: true,
          minlength: 5
        },
        confirm_password: {
          required: true,
          equalTo: "#signupPassword"
        }
      },
      messages: {
        fullname: "Please enter your full name",
        reg_username: {
          required: "Please choose a username",
          minlength: "Username must be at least 3 characters long"
        },
        email: "Please enter a valid email address",
        password: {
          required: "Please provide a password",
          minlength: "Password must be at least 5 characters long"
        },
        confirm_password: {
          required: "Please confirm your password",
          equalTo: "Passwords do not match"
        }
      },
      submitHandler: function(form) {
        let fullname = $(form).find("input[name='fullname']").val();
        let username = $(form).find("input[name='reg_username']").val();
        let email = $(form).find("input[name='email']").val();
        let password = $(form).find("input[name='password']").val();

        // Save credentials (using localStorage for this example)
        localStorage.setItem("registeredName", fullname);
        localStorage.setItem("registeredUsername", username);
        localStorage.setItem("registeredUser", email); 
        localStorage.setItem("registeredPass", password);

        alert("Registration successful! You can now log in with your username.");
        form.reset();

        // Switch back to login tab after successful registration
        $("#authTabs button[data-bs-target='#login']").tab("show");
      }
    });
  </script>
</body>
</html>